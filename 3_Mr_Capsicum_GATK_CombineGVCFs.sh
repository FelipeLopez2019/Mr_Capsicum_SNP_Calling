#!/bin/sh
#SBATCH --partition=longjobs
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=32
#SBATCH --time=13-00:00:00
#SBATCH --job-name=Allium01
#SBATCH -o %x_%j.out      # File to which STDOUT will be written
#SBATCH -e %x_%j.err      # File to which STDERR will be written
#SBATCH --mail-type=ALL


module load python/3.9_miniconda-4.10.3
source activate gatk4

# Define los archivos de entrada .g.vcf
gvcfs=("91.g.vcf"
"263.g.vcf"
"163.g.vcf"
"119.g.vcf"
"21.g.vcf"
"148.g.vcf"
"244.g.vcf"
"153.g.vcf"
"126.g.vcf"
"125.g.vcf"
"131.g.vcf"
"185.g.vcf"
"17.g.vcf"
"254.g.vcf"
"212.g.vcf"
"99.g.vcf"
"50.g.vcf"
"277.g.vcf"
"232.g.vcf"
"105.g.vcf"
"71.g.vcf"
"251.g.vcf"
"228.g.vcf"
"143.g.vcf"
"112.g.vcf"
"24.g.vcf"
"250.g.vcf"
"230.g.vcf"
"281.g.vcf"
"179.g.vcf"
"178.g.vcf"
"102.g.vcf"
"223.g.vcf"
"76.g.vcf"
"133.g.vcf"
"264.g.vcf"
"70.g.vcf"
"150.g.vcf"
"142.g.vcf"
"144.g.vcf"
"86.g.vcf"
"61.g.vcf"
"106.g.vcf"
"180.g.vcf"
"245.g.vcf"
"98.g.vcf"
"224.g.vcf"
"27.g.vcf"
"26.g.vcf"
"124.g.vcf"
"140.g.vcf"
"201.g.vcf"
"166.g.vcf"
"139.g.vcf"
"65.g.vcf"
"229.g.vcf"
"33.g.vcf"
"97.g.vcf"
"38.g.vcf"
"118.g.vcf"
"5.g.vcf"
"243.g.vcf"
"259.g.vcf"
"3.g.vcf"
"141.g.vcf"
"108.g.vcf"
"89.g.vcf"
"165A.g.vcf"
"248.g.vcf"
"35.g.vcf"
"15.g.vcf"
"100.g.vcf"
"195.g.vcf"
"270.g.vcf"
"176.g.vcf"
"117.g.vcf"
"48.g.vcf"
"4.g.vcf"
"113.g.vcf"
"165B.g.vcf"
"20.g.vcf"
"147.g.vcf"
"289.g.vcf"
"181.g.vcf"
"156.g.vcf"
"279.g.vcf"
"116.g.vcf"
"32.g.vcf"
"187.g.vcf"
"67.g.vcf"
"184.g.vcf"
"41.g.vcf"
"128.g.vcf"
"273.g.vcf"
"193.g.vcf"
"18.g.vcf"
"57.g.vcf"
"92.g.vcf"
"28.g.vcf"
"171.g.vcf"
"84.g.vcf"
"60.g.vcf"
"217.g.vcf"
"69.g.vcf"
"227.g.vcf"
"111.g.vcf"
"278.g.vcf"
"154.g.vcf"
"137.g.vcf"
"51.g.vcf"
"25.g.vcf"
"132.g.vcf"
"10.g.vcf"
"87.g.vcf"
"19.g.vcf"
"276.g.vcf"
"88.g.vcf"
"240.g.vcf"
"136.g.vcf"
"206.g.vcf"
"266.g.vcf"
"31.g.vcf"
"267.g.vcf"
"107.g.vcf"
"127.g.vcf"
"194.g.vcf"
"85.g.vcf"
"16.g.vcf"
"78.g.vcf"
"253.g.vcf"
"157.g.vcf"
"93.g.vcf"
"149.g.vcf"
"151.g.vcf"
"231.g.vcf"
"160.g.vcf"
"34.g.vcf"
"129.g.vcf"
"115.g.vcf"
"205.g.vcf"
"222.g.vcf"
"260.g.vcf"
"55.g.vcf"
"202.g.vcf"
"161.g.vcf"
"274.g.vcf"
"255.g.vcf"
"72.g.vcf"
"122A.g.vcf"
"164.g.vcf"
"268.g.vcf"
"12.g.vcf"
"130.g.vcf"
"158.g.vcf"
"200.g.vcf"
"265.g.vcf"
"210.g.vcf"
"1.g.vcf"
"155.g.vcf"
"174.g.vcf"
"103.g.vcf"
"196.g.vcf"
"114.g.vcf"
"177.g.vcf"
"123.g.vcf"
"233.g.vcf"
"192.g.vcf"
"110.g.vcf"
"246.g.vcf"
"29.g.vcf"
"215.g.vcf"
"234.g.vcf"
"242.g.vcf"
"46.g.vcf"
"168.g.vcf"
"182.g.vcf"
"44.g.vcf"
"96.g.vcf"
"241.g.vcf"
"252.g.vcf"
"53.g.vcf"
"220.g.vcf"
"95.g.vcf"
"288.g.vcf"
"45.g.vcf"
"214.g.vcf"
"198.g.vcf"
"101.g.vcf"
"37.g.vcf"
"282.g.vcf"
"262.g.vcf"
"63.g.vcf"
"146.g.vcf"
"209.g.vcf"
"191.g.vcf"
"261.g.vcf"
"297.g.vcf"
"236.g.vcf"
"52.g.vcf"
"145.g.vcf"
"249.g.vcf"
"291.g.vcf"
"293.g.vcf"
"294.g.vcf"
"54.g.vcf"
"219.g.vcf"
"30.g.vcf"
"109.g.vcf"
"73.g.vcf"
"290.g.vcf"
"216.g.vcf"
"221.g.vcf"
"122B.g.vcf"
"64.g.vcf"
"22.g.vcf"
"272.g.vcf"
"58.g.vcf"
"190.g.vcf"
"134.g.vcf"
"189.g.vcf"
"300.g.vcf"
"104.g.vcf"
"188.g.vcf"
"283.g.vcf"
"23.g.vcf"
"295.g.vcf"
"138.g.vcf"
"208.g.vcf"
"66.g.vcf"
"284.g.vcf"
"49.g.vcf"
"257.g.vcf"
"6.g.vcf"
"258.g.vcf"
"287.g.vcf"
"36.g.vcf"
"169.g.vcf"
"121.g.vcf"
"203.g.vcf"
"256.g.vcf"
"81.g.vcf"
"275.g.vcf"
"59.g.vcf"
"286.g.vcf"
"11.g.vcf"
"199.g.vcf"
"40.g.vcf"
"152.g.vcf"
"285.g.vcf"
"292.g.vcf"
"298.g.vcf"
"296.g.vcf"
"204B2.g.vcf"
"120.g.vcf"
"39.g.vcf"
"237.g.vcf"
"170.g.vcf"
"68.g.vcf"
"239.g.vcf"
"74.g.vcf"
"94.g.vcf"
"47.g.vcf"
"218A.g.vcf"
"280.g.vcf"
"235.g.vcf"
"269.g.vcf"
"175.g.vcf"
"77.g.vcf"
"219B.g.vcf"
"211.g.vcf"
"204B1.g.vcf"
"226.g.vcf"
"299.g.vcf"
"90.g.vcf"
"213.g.vcf"
"82.g.vcf"
"238.g.vcf"
"204A.g.vcf"
"62.g.vcf"
"167.g.vcf"
"197.g.vcf"
"225.g.vcf"
"75.g.vcf")

# Define el archivo de referencia
reference="/home/serverxxxx-lflopezh/genome/GCA_002878395.3_UCD10Xv1.1_genomic.fasta"


# Define el archivo de salida combinado
combined_gvcf="/home/serverxxxx-lflopezh/Capsicum_GATK4/combined.g.vcf.gz"

# Construye el comando con todos los archivos de entrada
input_args=""
for gvcf in "${gvcfs[@]}"; do
    input_args+=" --variant $gvcf"
done

# Ejecuta CombineGVCFs para combinar los archivos g.vcf
gatk CombineGVCFs \
    -R $reference \
    $input_args \
    -O $combined_gvcf